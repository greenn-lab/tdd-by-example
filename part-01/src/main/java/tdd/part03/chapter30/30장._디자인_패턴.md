# 디자인 패턴

패턴의 주요한 통찰,
> 우리가 언제나 완전히 다른 문제들을 해결하는 것 같지만, 우리가 푸는 문제 대다수는 사용하는 도구에 의해 생기는 것이 직면한 외부의 문제 때문에 생기는 것이 아니라는 점!  
> - 1970' Alexander Christopher.

설계를 보는 관점이 TDD와 디자인 패턴이 조금 다른 것 같대요.
아래는 TDD 의 단계별 패턴의 사용 분류인데요,  
|패턴|테스트작성|리팩토링|
|:--|:-:|:-:|
|커맨드|X||
|값 객체|X||
|널 객체||X|
|템플릿 메서드||X|
|플러거블 객체||X|
|플러거블 셀렉터||X|
|팩토리 메서드|X|X|
|임포스터|X|X|
|컴포지트|X|X|

처음 들어보는 패턴도 많네요, 패턴의 세계란....

## 커맨드
무얼 말하려는건지 잘 모르겠지만, 메서드 호출을 객체지향에서는 "메세지 보내기" 라고 표현한다면서 좋은 거라고 말씀하시네요.  
공감. 근데, 테스트를 실행할 때 커맨드 패턴을 잘 활용하라는 걸까요? 딱히 잘 모르겠네요.

## 값 객체
값 객체가 공유되면서 오염되는 내용을 말씀하시는 걸까요?  
이번 챕터를 전체적으로 잘 이해 못하고 있는 듯한 느낌이네요. 가능하면 어떤 값에 의미를 부여해서 값 객체를 활용하길 추천한다는 내용으로 받아들였고, 값 객체의 가치(?)를 비교하는 동등성 여부를 (항상) 잘 구현해야 한다고 말씀하시는 것 같아요.

## 널 객체
널 값을 비교하는 구분보다 널 객체를 만들게 되면 너절한 null 비교 구문이 사라진다는 얘기를 하고 싶은 것 같아요.  
TKO(Technical Knock-Out) 라는 좋은말도 있군요.

## 템플릿 메서드
`setup()` `run()` `teardown()` 으로 테스트를 실행하는 탬플릿을 두고 `setup()` 이 필요 없을 땐 말고, 필요하면 상속해서 구현하는 식으로 사용하라는 것 같네요.

## 플러거블 객체
괜찮은 예제라서 코드를 안 적을 수 없군요.  
```java
Figure selected;

public void mouseDown() {
  selected = findFigure();

  if (selected != null) {
    select(selected);
  }
}

public void mouseMove() {
  if (selected != null) {
      move(selected);
  } else {
      moveSelectionRectangle();
  }
}

public void mouseUp() {
  if (selected != null) {
      selectAll();
  }
}
```
이 코드는 그림판 같은 툴에서 mouseDown 이벤트가 발생됐을 때, 해당 위치에 어떤 도형이 있으면 그 도형을 선택하고 아니면 도형들을 선택하는 사각 박스가 나와서 mouseUp 이벤트가 됐을 때, 그 영역내의 도형들이 선택되는 코드인데요.
너절하게 if 로 도배가 되었고, 더 많은 이벤트들이 중간에 끼어들거나 하면 똑같이 null check 가 되겠죠.
```java
SelectionMode mode;

public void mouseDown() {
  selected = findFigure();

  if (selected != null) {
    mode = new SingleSelection(selected);
  } else {
    mode = MultipleSelection();
  }
}

public void mouseMove() {
  mode.mouseMove();
}

public void mouseUP() {
  mode.mouseUp();
}
``` 
요렇게 하면 깔끔하게 정리가 되네요. 당연히 `SingleSelection`, `MultipleSelection` 은 동일한 인터페이스를 구현하게 해야 되는 거겠죠.
이런 객체를 **플러거블 객체** 라고 하나봐요. 생경한 용어네요. 어쨌든 좋은 전략인 것 같아요.

## 플러거블 셀렉터
뭘 하자는 건지 또 모르겠음. 파트2 에서 파이선의 `getattr(...)` 같이 상속이나 거추장스러운 조건 문법을 피하려면 리플렉션을 활용하라는 말인가요? 음....  
아참 java 7부턴가는 switch 에서 string case 가 가능해졌는데, 개정판이 얼른 나와야겠네요.

## 팩토리 메서드
유연성을 위해서 객체를 생성할 때, 생성자 말고 우회적인 방법을 팩토리 매서드 패턴을 쓰죠.  
우리 `Dollar` 인스턴스를 만들 때 `Money.dollar(5)` 이런식으로 한 것 처럼요.   
저도 미니멀 라이프를 추구하는 입장에서 구태여 새로운 무언가를 만들어내는 것을 싫어하는 입장인지라 기본 문법으로 생성자를 그냥 쓰는게 좋다고 생각해요.

## 사칭: 사기꾼
기존 코드에 새로운 변이를 도입하려면, 절차지향에서는 조건문이 새롭게 생겨야 하고, 객체지향에서는 다형성으로 새로운 변이를 구현한 객체를 만들어야겠죠.  
뭐 여건이 그렇지 않다고 한다면 어떡할 거냐는 질문에 사기꾼처럼 행동하자는 것 같기도 하고.  
아 진짜, 뭔말을 하는 건지 잘 모르겠어요.

## 컴포지트
새로운 행위를 구성해서 복잡도를 낮춘다는 내용으로 얘길 하시는데, 조영호님의 오브젝트가 정말 쉽고 예제를 잘 골라서 쓴 좋은 책 인 것 같네요. 벡선생님 예제와 설명은 좀 어려운 것 같은데... 그건 저라서 그런거겠죠 😭

## 수집 매개 변수
수집 매개 변수를 도입해서 깔끔하게 뭔가를 할 수 있다는 걸까요 `BufferedWriter.newLine()` 같은 걸 말하는 걸까요?  
이게 뭐가 좋다는 건지, 이런걸 왜 써야한달지 이유가 불분명 한 것 같아요.

## 싱글톤
싱글톤 쓰지말지어다. 이말씀 ?!



