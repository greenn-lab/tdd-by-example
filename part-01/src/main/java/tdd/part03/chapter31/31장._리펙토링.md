# 리팩토링
TDD 에서는 리팩토링을 특이한 방법으로 사용한대요. 이번 챕터도 답답한 얘기만 나올 것 같은 느낌 이네요.

## 차이점 일치 시키기
비슷해 보이는 두 코드 조각을 하나로 만들려면 점점 닮아가도록 조금씩 변화를 해가다가 완전히 같아지면 하나로 합치는데, 신경을 고문하는 경험이 될 수 있다고 하네요.  
2시간 정도 닮아가도록 변화를 주다가 깨닳아요, 이건 같을 수 없다고. 그러면 미친 사람처럼 길길이 날뛰게 될 것 같아요.  
그냥 높은 경지의 통찰과 해안으로 가능한 영역이라고 말해주면 좋을 것을 방법을 계속 서술하시네요.

- 두 반복문의 구조가 비슷하면,
- 조건문에 의해 나눠지는 두 분기의 코드가 비슷하면,
- 두 클래스가 비슷하면,

그러면 둘을 동일하게 만들고 나서 하나를 제거하거나 합치거나 한대요.

## 변화 격리하기
객체나 메서드의 일부만 바꾸려면, 그 해당 부분을 격리한대요.  
"격리" 라고 하니깐 좀 어려운데, 그냥 "메서드로 분리한다" 라고 하니깐 이해가 편한듯 싶네요.

## 데이터 이주 시키기
데이터를 이주한다는 게 뭔말 일까요? 이게, 책에서 하는 얘기가 잘 이해가 안되니까 짜증이 나기 시작한 것 같아요.  
저자(또는 번역자)가 선택한 단어에도 날카롭게 반응하고 있어요. 😤😤 내가 부족한 걸 남탓으로 돌리는 희한한 재주죠.

차근 차근 데이터를 옮겨간다는데, 무슨 말인지...

## 메서드 추출하기
길고 복잡한 코드에서 컨텍스트를 분리하는 거죠.

책에서 소개한 방법은 길지만 IDE 에서 메서드 분리 기능을 수행하면 파라미터 후보를 선택하고 손쉽게 진행 할 수 있으니까 이 방법은 건너뛰기!

## 메서드 인라인
산재된 제어의 흐름을 단순화 하려면 메서드로 분리된 걸 다시 뭉개 놓으란 말인가요? 납득이 안가는데...

## 인터페이스 추가하기
책을 정리하기 전에, 인터페이스를 추가한다는 게 리팩토링의 영역을 벗어나는 건 아닐까 싶은 생각이 드네요. 처음 부분에 의미를 벗어나지 않는 거라면 리팩토링이랬지만, 인터페이스가 바껴서 객체들이 서로 주고받는 메세지가 달라지는 상황까지 고려하는 건 너무 혹독한 것 같네요.

Rectangle 클래스가 있고 Oval 클래스를 추가하고 싶다면 먼저 Shape 인터페이스를 만들어 Rectangle 하고 Oval 을 다형성 시키라고 하네요. (이게 진짜 리팩토링을 얘기하는 거 맞는 거죠?)

## 메서드 옮기기
메서드는 앞서 얘기한대로 객체지향에서는 메세지를 주고 받는 소통의 역할을 하는데, 클래스에서 어울리지 않는 메세지가 있다면 옮기라는 말씀.

어떤 메서드에서 다른 객체에 하나 이상의 메세지를 보내면 의심해보래요. 
```java
class Shape {
  private Rectangle bounds;
  
  public void compute() {
    int width = bounds.right() - bounds.left();
    int height = bounds.bottom() - bounds.top();
    int area = width * height;
    
    // ...
  }
}
```  
이런것들 말예요. 다음처럼 바꾸는게 좋겠대요.
```java
class Rectangle {
  public int area() {
    int width = this.right() - this.left();
    int height = this.bottom() - this.top();
  
    return width * height;
  }
}

class Shape {
  private Rectangle bounds;

  public void compute() {
    int area = bounds.area();

    // ...
  } 
}
```

## 메서드 객체
여러 개의 매개변수와 지역변수를 갖는 메서드는 객체로 꺼낸대요.
크게 이점이 있는지는 잘 모르겠어요. 메서드 객체를 생성하면 새로운 이름 공간을 얻게 된다는 게, 개별적인 필드를 선언 할 수 있다는 얘기 일까요?

## 매개 변수 추가
이건 IDE 가 알아서 해주는데...

## 메서드 매개 변수를 생성자 매개 변수로 바꾸기
같은 매개 변수를 동일한 객체의 서로 다른 메서드에 전달하는 경우라면 API 를 단순화 하기 위해 생상자를 사용하고 final 필드를 사용하라는 것 같네요.
